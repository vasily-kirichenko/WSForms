(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;$.Define($$,{WebSharper:{Forms:{Attr:{SubmitterValidate:function(O){var P,S,T,V,W,X;P=c.Handler("click",function(){return function(){return O.Trigger();};});S=d.Const("disabled");T=function(U){return f.IsFailure(U);};V=O.get_Input();W=g.Map(T,V);X=c.DynamicPred("disabled",W,S);return h.Append(P,X);}},Doc:{ButtonValidate:function(Y,Z,_0){return i.Element("button",j.append([k.SubmitterValidate(_0)],Z),l.ofArray([i.TextNode(Y)]));},ShowErrors:function(_1,_2){return i.BindView(function(_3){var _4,_5;if(_3.$==1){_5=_3.$0;_4=_2(_5);}else{_4=i.get_Empty();}return _4;},_1);},ShowSuccess:function(_6,_7){return i.BindView(function(_8){var _9,_;if(_8.$==1){_8.$0;_9=i.get_Empty();}else{_=_8.$0;_9=_7(_);}return _9;},_6);}},ErrorMessage:$.Class({get_Id:function(){return this.id;},get_Text:function(){return this.message;}},{Create:function(ba,bb){return m.New(ba,bb);},Create1:function(bb,bc){return m.New(bb.id,bc);},New:function(bd,be){var bf;bf=$.New(this,{});bf.id=bd;bf.message=be;return bf;}}),Form:{ApJoin:function(bg,bh){var bi,bl,bm,bn,bo;bi=function(bj){return function(bk){return f.ApJoin(bj,bk);};};bl=bg.view;bm=bh.view;bn=bg.render;bo=bh.render;return $.New(n,{id:o.Id(),view:g.Map2(bi,bl,bm),render:function(bp){return bo(bn(bp));}});},Apply:function(bq,br){var bs,bv,bw,bx,by;bs=function(bt){return function(bu){return f.Apply(bt,bu);};};bv=bq.view;bw=br.view;bx=bq.render;by=br.render;return $.New(n,{id:o.Id(),view:g.Map2(bs,bv,bw),render:function(bz){return by(bx(bz));}});},Builder:$.Class({Bind:function(bA,bB){return p.Dependent2(bA,bB);},Return:function(bC){return n.Return(bC);},ReturnFrom:function(bD){return bD;},Yield:function(bE){return p.Yield(bE);},YieldFrom:function(bF){return bF;},Zero:function(){return n.ReturnFailure();}}),Dependent:{Make:function(bG,bH){var bI,bN;bI=q.memoize(function(bJ){var bK,bL;bK=bH(bJ);bL=bK.view;return $.New(n,{id:bK.id,view:bL,render:function(bM){return bK.render.call(null,bM);}});});bN=g.Map(function(bO){return f.Map(bI,bO);},bG.view);return r.New(function(bP){return bG.render.call(null,bP);},bN);}},Dependent1:$.Class({RenderDependent:function(bQ){var bR,bV;bR=function(bS){var bT,bU;if(bS.$==1){bT=i.get_Empty();}else{bU=bS.$0;bT=bU.render.call(null,bQ);}return bT;};bV=this.pOut;return i.BindView(bR,bV);},RenderPrimary:function(bW){return this.renderPrimary.call(null,bW);},get_View:function(){return this.out;}},{New:function(bX,bY){var bZ;bZ=$.New(this,{});bZ.renderPrimary=bX;bZ.pOut=bY;bZ.out=d.Bind(function(b0){var b1,b2,b3;if(b0.$==1){b2=b0.$0;b1=d.Const({$:1,$0:b2});}else{b3=b0.$0;b1=b3.view;}return b1;},bZ.pOut);return bZ;}}),Dependent2:function(b4,b5){var b6;b6=s.Make(b4,b5);return $.New(n,{id:o.Id(),view:b6.get_View(),render:function(b7){return b7(b6);}});},FlushErrors:function(b8){return p.MapResult(function(b9){return b9.$==1?{$:1,$0:$.New(t,{$:0})}:b9;},b8);},Many:{Collection:$.Class({Add:function(b_){return this.add(b_);},Render:function(b$){var ca,cb,ce;ca=this.changesView;cb=function(cc){var cd;cc[0];cc[1];cd=cc[2];return cd;};ce=function(cf){var cg,ch;cg=cf[0];ch=cf[1];cf[2];return cg.render.call(null,b$(ch));};return i.ConvertBy(cb,ce,ca);},RenderAdder:function(ci){var cj,ck,cm=this,cn,co,cp;cj=this.adder.render.call(null,ci);ck=function(cl){return cm.adderView(cl);};cn=cm.adder.view;co=g.Map(ck,cn);cp=i.EmbedView(co);return i.Append(cp,cj);},add:function(cq){var cr,cs;this.arr.Add(this.mk(cq));cr=this["var"];cs=function(ct){return ct;};return u.Update(cr,cs);},adderView:function(cu){var cv,cw;if(cu.$==0){cw=cu.$0;cv=this.add(cw);}else{cv=null;}return i.get_Empty();},get_View:function(){return this.out;},mk:function(cx){var cy,cz,cC,cE,cF,cG,cJ=this,cN,cP,cQ,cR,cS,cT,c1,c2,c4,c5,c6,c7,c8,de,df,dg,dj,dk,dn,_do,dp;cy=(w.Int())(null);cz=function(cA){var cB;cA[0];cA[1];cB=cA[2];return cy===cB;};cC=function(cD){return j.findIndex(cz,cD);};cE=this["var"].get_View();cF=g.Map(cC,cE);cG=function(){var cI,cK,cL;cI=cC(cJ.arr);cJ.arr.RemoveAt(cI);cK=cJ["var"];cL=function(cM){return cM;};return u.Update(cK,cL);};cN=function(cO){return cO===0?{$:1,$0:$.New(t,{$:0})}:{$:0,$0:true};};cP=g.Map(cN,cF);cQ=cJ.arr.get_Count()===0?{$:1,$0:$.New(t,{$:0})}:{$:0,$0:false};cR=x.Create(cP,cQ);cS=cR.get_View();cT=function(cU){var cV,cW,cX,cY,cZ;if(cU.$==0){if(cU.$0){cX=cC(cJ.arr);v["List`1.Swap"](cJ.arr,cX,cX-1);cY=cJ["var"];cZ=function(c0){return c0;};cW=u.Update(cY,cZ);}else{cW=null;}cV=cW;}else{cV=null;}return cV;};c1=g.Map(cT,cS);c2=function(c3){return c3===cJ.arr.get_Count()-1?{$:1,$0:$.New(t,{$:0})}:{$:0,$0:true};};c4=g.Map(c2,cF);c5={$:1,$0:$.New(t,{$:0})};c6=x.Create(c4,c5);c7=c6.get_View();c8=function(c9){var c_,c$,da,db,dc;if(c9.$==0){if(c9.$0){da=cC(cJ.arr);v["List`1.Swap"](cJ.arr,da,da+1);db=cJ["var"];dc=function(dd){return dd;};c$=u.Update(db,dc);}else{c$=null;}c_=c$;}else{c_=null;}return c_;};de=g.Map(c8,c7);df=cJ.p.call(null,cx);dg=function(dh){return function(){return dh;};};dj=df.view;dk=function(){return function(){return null;};};dn=g.Map2(dk,c1,de);_do=g.Map2(dg,dj,dn);dp=$.New(n,{id:df.id,view:_do,render:df.render});return[dp,y.New(cG,cR,c6),cy];}},{New:function(dq,dr,ds){var dt,du,dx,dy,dO,dP;dt=$.New(this,{});dt.p=dq;dt.adder=ds;dt.arr=B.New2();dt["var"]=C.Create(dt.arr);du=dt.arr;j.iter(function(dv){var dw;dw=dt.mk(dv);return du.Add(dw);},dr);dx=dt["var"].get_View();dy=function(dz){var dA,dB,dH,dI,dL;dA=dz.ToArray();dB=function(dC){var dD,dE,dG;dD=dC[0];dE=function(){return[dC];};dG=dD.view;return g.Map(dE,dG);};dH=d.Const(j.empty());dI=function(dJ){return function(dK){return j.append(dJ,dK);};};dL=function(dM){return function(dN){return g.Map2(dI,dM,dN);};};return D.MapReduce(dB,dH,dL,dA);};dt.changesView=d.Bind(dy,dx);dO=dt["var"].get_View();dP=function(dQ){var dR,dS,d0,d1,d4,d7;dR=dQ.ToArray();dS=function(dT){var dU,dV,dX,dZ;dU=dT[0];dT[1];dT[2];dV=function(dW){return[dW];};dX=function(dY){return f.Map(dV,dY);};dZ=dU.view;return g.Map(dX,dZ);};d0=d.Const({$:0,$0:j.empty()});d1=function(d2){return function(d3){return j.append(d2,d3);};};d4=function(d5){return function(d6){return E.Append(d1,d5,d6);};};d7=function(d8){return function(d9){return g.Map2(d4,d8,d9);};};return D.MapReduce(dS,d0,d7,dR);};dt.out=d.Bind(dP,dO);return dt;}}),CollectionWithDefault:$.Class({AddOne:function(){return this.Add(this["default"]);}},{New:function(d_,d$,ea,eb){var ec;ec=$.New(this,G.New(d_,d$,ea));ec["default"]=eb;return ec;}}),Fresh:{Int:$.Field(function(){var ed;ed=[0];return function(){H.incr(ed);return ed[0];};})},ItemOperations:$.Class({Delete:function(){return this["delete"].call(null,null);},get_MoveDown:function(){return this.moveDown;},get_MoveUp:function(){return this.moveUp;}},{New:function(ef,eg,eh){var ei;ei=$.New(this,{});ei["delete"]=ef;ei.moveUp=eg;ei.moveDown=eh;return ei;}}),"List`1.Swap":function(ej,ek,el){var em;em=ej.get_Item(ek);ej.set_Item(ek,ej.get_Item(el));return ej.set_Item(el,em);}},Many1:function(en,eo,ep){var eq,er;eq=ep(eo);er=F.New(ep,en,eq,eo);return $.New(n,{id:o.Id(),view:er.get_View(),render:function(es){return es(er);}});},ManyForm:function(et,eu,ev){var ew;ew=G.New(ev,et,eu);return $.New(n,{id:o.Id(),view:ew.get_View(),render:function(ex){return ex(ew);}});},Map:function(ey,ez){return p.MapResult(function(eA){return f.Map(ey,eA);},ez);},MapAsync:function(eB,eC){var eD;eD=function(eE){var eF,eG,eI;if(eE.$==1){eG=eE.$0;eF=I.Delay(function(){return I.Return({$:1,$0:eG});});}else{eI=eE.$0;eF=I.Delay(function(){return I.Bind(eB(eI),function(eK){return I.Return({$:0,$0:eK});});});}return eF;};return p.MapAsyncResult(eD,eC);},MapAsyncResult:function(eL,eM){var eN;eN=eM.view;return $.New(n,{id:eM.id,view:g.MapAsync(eL,eN),render:eM.render});},MapRenderArgs:function(eO,eP){return $.New(n,{id:eP.id,view:eP.view,render:function(eQ){return eQ(eP.render.call(null,eO));}});},MapResult:function(eR,eS){var eT;eT=eS.view;return $.New(n,{id:eS.id,view:g.Map(eR,eT),render:eS.render});},MapToAsyncResult:function(eU,eV){var eW;eW=function(eX){var eY,eZ,e1;if(eX.$==1){eZ=eX.$0;eY=I.Delay(function(){return I.Return({$:1,$0:eZ});});}else{e1=eX.$0;eY=I.Delay(function(){return eU(e1);});}return eY;};return p.MapAsyncResult(eW,eV);},MapToResult:function(e3,e4){return p.MapResult(function(e5){return f.Bind(e3,e5);},e4);},Run:function(e6,e7){return p.Map(function(e8){e6(e8);return e8;},e7);},RunResult:function(e9,e_){return p.MapResult(function(e$){e9(e$);return e$;},e_);},TransmitView:function(fa){return $.New(n,{id:fa.id,view:fa.view,render:function(fb){return(fa.render.call(null,fb))(fa.view);}});},TransmitViewMap:function(fc,fd){return p.TransmitViewMapResult(function(fe){return f.Map(fc,fe);},fd);},TransmitViewMapResult:function(ff,fg){return $.New(n,{id:fg.id,view:fg.view,render:function(fh){var fi;fi=fg.view;return(fg.render.call(null,fh))(g.Map(ff,fi));}});},WithSubmit:function(fj){var fk,fl,fm;fk=fj.view;fl={$:1,$0:$.New(t,{$:0})};fm=x.Create(fk,fl);return $.New(n,{id:o.Id(),view:fm.get_View(),render:function(fn){return(fj.render.call(null,fn))(fm);}});},Yield:function(fo){return n.YieldVar(C.Create(fo));},YieldFailure:function(){var fp,fq,fr,fs,fu;fp=C.Create(undefined);fq=fp.get_View();fr={$:1,$0:$.New(t,{$:0})};fs=function(ft){return{$:0,$0:ft};};fu=g.Map(fs,fq);return $.New(n,{id:u.GetId(fp),view:g.SnapshotOn(fr,fq,fu),render:function(fv){return fv(fp);}});},YieldOption:function(fw,fx){var fy,fz,fB;fy=C.Create(J.DefaultArg(fw,fx));fz=function(fA){return{$:0,$0:K.Equals(fA,fx)?{$:0}:{$:1,$0:fA}};};fB=fy.get_View();return $.New(n,{id:u.GetId(fy),view:g.Map(fz,fB),render:function(fC){return fC(fy);}});}},Form1:$.Class({get_Id:function(){return this.id;},get_Render:function(){return this.render;},get_View:function(){return this.view;}},{Create:function(fD,fE){return $.New(n,{id:o.Id(),view:fD,render:fE});},GetView:function(fF){return fF.view;},Render:function(fG,fH){var fI,fJ,fL,fM,fN;fI=fH.render.call(null,fG);fJ=function(){return i.get_Empty();};fL=fH.view;fM=g.Map(fJ,fL);fN=i.EmbedView(fM);return i.Append(fN,fI);},RenderDependent:function(fO,fP){return fO.RenderDependent(fP);},RenderMany:function(fQ,fR){return fQ.Render(fR);},RenderManyAdder:function(fS,fT){return fS.RenderAdder(fT);},RenderPrimary:function(fU,fV){return fU.RenderPrimary(fV);},Return:function(fW){return $.New(n,{id:o.Id(),view:d.Const({$:0,$0:fW}),render:function(fX){return fX;}});},ReturnFailure:function(){return $.New(n,{id:o.Id(),view:d.Const({$:1,$0:$.New(t,{$:0})}),render:function(fY){return fY;}});},YieldVar:function(fZ){var f0,f2;f0=function(f1){return{$:0,$0:f1};};f2=fZ.get_View();return $.New(n,{id:u.GetId(fZ),view:g.Map(f0,f2),render:function(f3){return f3(fZ);}});}}),Fresh:{Id:function(){H.decr(o.lastId());return(o.lastId())[0];},lastId:$.Field(function(){return[-1];})},Pervasives:{op_LessMultiplyGreater:function(f4,f5){return p.Apply(f4,f5);},op_LessMultiplyQmarkGreater:function(f6,f7){return p.ApJoin(f6,f7);}},Result:$.Class({},{Append:function(f8,f9,f_){var f$,ga,gb,gc,gd,ge,gf;if(f9.$==0){ga=f9.$0;if(f_.$==0){gc=f_.$0;gb={$:0,$0:(f8(ga))(gc)};}else{gb=f_;}f$=gb;}else{gd=f9.$0;if(f_.$==0){ge=f9;}else{gf=f_.$0;ge={$:1,$0:l.append(gd,gf)};}f$=ge;}return f$;},FailWith:function(gg,gh){var gi,gj,gk;if(gh.$==0){gj=o.Id();}else{gk=gh.$0;gj=gk;}gi=gj;return{$:1,$0:l.ofArray([m.New(gi,gg)])};}}),Result1:$.Class({},{ApJoin:function(gl,gm){var gn,go,gp,gq,gr,gs,gt,gu,gv,gw;if(gl.$==0){go=gl.$0;if(gm.$==0){if(gm.$0.$==0){gr=gm.$0.$0;gq={$:0,$0:go(gr)};}else{gs=gm.$0.$0;gq={$:1,$0:gs};}gp=gq;}else{gt=gm.$0;gp={$:1,$0:gt};}gn=gp;}else{gu=gl.$0;if(gm.$==0){gv={$:1,$0:gu};}else{gw=gm.$0;gv={$:1,$0:l.append(gu,gw)};}gn=gv;}return gn;},Apply:function(gx,gy){var gz,gA,gB,gC,gD,gE,gF,gG;if(gx.$==0){gA=gx.$0;if(gy.$==0){gC=gy.$0;gB={$:0,$0:gA(gC)};}else{gD=gy.$0;gB={$:1,$0:gD};}gz=gB;}else{gE=gx.$0;if(gy.$==0){gF={$:1,$0:gE};}else{gG=gy.$0;gF={$:1,$0:l.append(gE,gG)};}gz=gF;}return gz;},Bind:function(gH,gI){var gJ,gK,gL;if(gI.$==0){gK=gI.$0;gJ=gH(gK);}else{gL=gI.$0;gJ={$:1,$0:gL};}return gJ;},IsFailure:function(gM){return gM.$==1?true:false;},IsSuccess:function(gN){return gN.$==1?false:true;},Map:function(gO,gP){var gQ,gR,gS;if(gP.$==1){gR=gP.$0;gQ={$:1,$0:gR};}else{gS=gP.$0;gQ={$:0,$0:gO(gS)};}return gQ;}}),Utils:{memoize:function(gT){var gU;gU=L.New12();return function(gV){var gW,gX;if(gU.ContainsKey(gV)){gW=gU.get_Item(gV);}else{gX=gT(gV);gU.set_Item(gV,gX);gW=gX;}return gW;};}},Validation:{Is:function(gY,gZ,g0){var g1;g1=function(g2){var g3,g4;if(g2.$==1){g3=g2;}else{g4=g2.$0;g3=gY(g4)?g2:{$:1,$0:l.ofArray([m.New(g0.id,gZ)])};}return g3;};return p.MapResult(g1,g0);},IsMatch:function(g5,g6,g7){var g8;g8=new N(g5);return M.Is(function(g9){return g8.test(g9);},g6,g7);},IsNotEmpty:function(g_,g$){return M.Is(function(ha){return ha!=="";},g_,g$);},MapValidCheckedInput:function(hb,hc){var hd;hd=function(he){var hf,hg,hh,hi;if(he.$==1){hg=he.$0;hf={$:1,$0:hg};}else{if(he.$0.$==0){hi=he.$0.$0;hh={$:0,$0:hi};}else{hh={$:1,$0:l.ofArray([m.Create1(hc,hb)])};}hf=hh;}return hf;};return p.MapResult(hd,hc);}},View:$.Class({},{Through:function(hj,hk){var hl;hl=function(hm){var hn,ho,hp;if(hm.$==1){ho=hm.$0;hp=function(hq){return hq.get_Id()===u.GetId(hk);};hn={$:1,$0:l.filter(hp,ho)};}else{hn=hm;}return hn;};return g.Map(hl,hj);},Through1:function(hr,hs){var ht;ht=function(hu){var hv,hw,hx;if(hu.$==1){hw=hu.$0;hx=function(hy){return hy.get_Id()===hs.id;};hv={$:1,$0:l.filter(hx,hw)};}else{hv=hu;}return hv;};return g.Map(ht,hr);}})}}});$.OnInit(function(){a=$.Safe($$.WebSharper.UI);b=$.Safe(a.Next);c=$.Safe(b.AttrModule);d=$.Safe(b.View1);e=$.Safe($$.WebSharper.Forms);f=$.Safe(e.Result1);g=$.Safe(b.View);h=$.Safe(b.AttrProxy);i=$.Safe(b.Doc);j=$.Safe($$.WebSharper.Seq);k=$.Safe(e.Attr);l=$.Safe($$.WebSharper.List);m=$.Safe(e.ErrorMessage);n=$.Safe(e.Form1);o=$.Safe(e.Fresh);p=$.Safe(e.Form);q=$.Safe(e.Utils);r=$.Safe(p.Dependent1);s=$.Safe(p.Dependent);t=$.Safe(l.T);u=$.Safe(b.Var1);v=$.Safe(p.Many);w=$.Safe(v.Fresh);x=$.Safe(b.Submitter);y=$.Safe(v.ItemOperations);z=$.Safe($$.WebSharper.Collections);A=$.Safe(z.ResizeArray);B=$.Safe(A.ResizeArrayProxy);C=$.Safe(b.Var);D=$.Safe(b.Array);E=$.Safe(e.Result);F=$.Safe(v.CollectionWithDefault);G=$.Safe(v.Collection);H=$.Safe($$.WebSharper.Ref);I=$.Safe($$.WebSharper.Concurrency);J=$.Safe($$.WebSharper.Operators);K=$.Safe($$.WebSharper.Unchecked);L=$.Safe(z.Dictionary);M=$.Safe(e.Validation);return N=$.Safe($$.RegExp);});$.OnLoad(function(){$.Inherit(F,G);o.lastId();w.Int();return;});}());
